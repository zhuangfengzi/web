<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³è§†é¢‘é€šè¯ - åŠ å…¥æˆ¿é—´</title>
    <script src="https://webrtc-solutions-logs.oss-cn-beijing.aliyuncs.com/rtc_web_sdk/1.24.7/AliRTCSdk-1.24.7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1A1A2E 0%, #16213E 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .container {
            flex: 1;
            position: relative;
        }
        
        /* éŸ³é¢‘é€šè¯å¸ƒå±€ */
        .audio-mode {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }
        
        .avatar-container {
            margin-bottom: 40px;
        }
        
        .avatar {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .avatar-icon {
            font-size: 80px;
            color: white;
        }
        
        .user-info {
            color: white;
        }
        
        .user-info h2 {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .call-status {
            font-size: 16px;
            color: #4CAF50;
        }
        
        .audio-visualizer {
            margin: 30px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        
        .audio-bar {
            width: 4px;
            height: 20px;
            background: #4CAF50;
            border-radius: 2px;
            animation: audioWave 1s ease-in-out infinite;
        }
        
        .audio-bar:nth-child(2) { animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { animation-delay: 0.4s; }
        
        @keyframes audioWave {
            0%, 100% { height: 20px; }
            50% { height: 40px; }
        }
        
        /* è§†é¢‘é€šè¯å¸ƒå±€ */
        .video-container {
            flex: 1;
            position: relative;
            background: #000;
        }
        
        .remote-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #333;
        }
        
        .local-video {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 160px;
            height: 120px;
            border: 2px solid #fff;
            border-radius: 8px;
            object-fit: cover;
            background: #666;
        }
        
        /* æ§åˆ¶æŒ‰é’® */
        .controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }
        
        .control-btn.active {
            background: #e74c3c;
        }
        
        .control-btn.hangup {
            background: #e74c3c;
            width: 60px;
            height: 60px;
        }
        
        .control-btn.hangup:hover {
            background: #c0392b;
        }
        
        /* ç­‰å¾…ç•Œé¢ */
        .waiting-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.8);
            color: white;
            text-align: center;
        }
        
        .loading {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-screen {
            background: #e74c3c;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .retry-btn {
            margin-top: 20px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: white;
            color: #e74c3c;
            cursor: pointer;
            font-size: 16px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .local-video {
                width: 120px;
                height: 90px;
                top: 10px;
                right: 10px;
            }
            
            .controls {
                gap: 15px;
                padding: 15px;
            }
            
            .control-btn {
                width: 45px;
                height: 45px;
            }
            
            .control-btn.hangup {
                width: 55px;
                height: 55px;
            }
            
            .avatar {
                width: 150px;
                height: 150px;
            }
            
            .avatar-icon {
                font-size: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <!-- éŸ³é¢‘é€šè¯æ¨¡å¼ -->
        <div id="audioMode" class="audio-mode" style="display: none;">
            <div class="avatar-container">
                <div class="avatar">
                    <div class="avatar-icon">ğŸ§</div>
                </div>
                <div class="user-info">
                    <h2 id="remoteUserName">ç­‰å¾…å¯¹æ–¹åŠ å…¥...</h2>
                    <div class="call-status" id="callStatus">éŸ³é¢‘é€šè¯</div>
                </div>
            </div>
            
            <div class="audio-visualizer" id="audioVisualizer" style="display: none;">
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
            </div>
        </div>
        
        <!-- è§†é¢‘é€šè¯æ¨¡å¼ -->
        <div id="videoMode" class="video-container" style="display: none;">
            <video id="remoteVideo" class="remote-video" autoplay playsinline></video>
            <video id="localVideo" class="local-video" autoplay playsinline muted></video>
        </div>
        
        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button id="muteBtn" class="control-btn" onclick="toggleMute()" title="é™éŸ³/å–æ¶ˆé™éŸ³">
                ğŸ¤
            </button>
            <button id="videoBtn" class="control-btn" onclick="toggleVideo()" title="å¼€å¯/å…³é—­è§†é¢‘" style="display: none;">
                ğŸ“¹
            </button>
            <button id="hangupBtn" class="control-btn hangup" onclick="hangup()" title="æŒ‚æ–­">
                ğŸ“
            </button>
            <button id="switchBtn" class="control-btn" onclick="switchCamera()" title="åˆ‡æ¢æ‘„åƒå¤´" style="display: none;">
                ğŸ”„
            </button>
        </div>
        
        <!-- ç­‰å¾…ç•Œé¢ -->
        <div id="waitingScreen" class="waiting-screen">
            <div class="loading"></div>
            <h2>æ­£åœ¨è¿æ¥...</h2>
            <p>æˆ¿é—´å·: <span id="roomIdDisplay"></span></p>
            <p id="callTypeDisplay"></p>
        </div>
        
        <!-- é”™è¯¯ç•Œé¢ -->
        <div id="errorScreen" class="error-screen" style="display: none;">
            <h2>è¿æ¥å¤±è´¥</h2>
            <p id="errorMessage"></p>
            <div style="margin-top: 20px;">
                <button class="retry-btn" onclick="location.reload()">é‡æ–°å°è¯•</button>
                <button class="retry-btn" onclick="window.open('help.html', '_blank')" style="background: #007bff; margin-left: 10px;">æŸ¥çœ‹å¸®åŠ©</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
        class VideoChat {
            constructor() {
                this.rtcEngine = null;
                this.roomId = null;
                this.userId = null;
                this.callType = 'video'; // 'audio' æˆ– 'video'
                this.isAudioMuted = false;
                this.isVideoMuted = false;
                this.isJoined = false;
                this.localTracks = {
                    video: null,
                    audio: null
                };
                this.remoteTracks = {};
                
                this.init();
            }
            
            init() {
                // è§£æURLå‚æ•°
                const urlParams = new URLSearchParams(window.location.search);
                this.roomId = urlParams.get('id');
                this.callType = urlParams.get('type') || 'video';
                
                if (!this.roomId) {
                    this.showError('æ— æ•ˆçš„æˆ¿é—´é“¾æ¥');
                    return;
                }
                
                // æ˜¾ç¤ºæˆ¿é—´ä¿¡æ¯
                document.getElementById('roomIdDisplay').textContent = this.roomId;
                document.getElementById('callTypeDisplay').textContent = 
                    this.callType === 'video' ? 'è§†é¢‘é€šè¯æ¨¡å¼' : 'éŸ³é¢‘é€šè¯æ¨¡å¼';
                
                // è®¾ç½®UIæ¨¡å¼
                this.setupUIMode();
                
                this.userId = 'web_user_' + Date.now();
                this.initRTC();
            }
            
            setupUIMode() {
                const audioMode = document.getElementById('audioMode');
                const videoMode = document.getElementById('videoMode');
                const videoBtn = document.getElementById('videoBtn');
                const switchBtn = document.getElementById('switchBtn');
                
                if (this.callType === 'audio') {
                    // éŸ³é¢‘é€šè¯æ¨¡å¼
                    audioMode.style.display = 'flex';
                    videoMode.style.display = 'none';
                    videoBtn.style.display = 'none';
                    switchBtn.style.display = 'none';
                } else {
                    // è§†é¢‘é€šè¯æ¨¡å¼
                    audioMode.style.display = 'none';
                    videoMode.style.display = 'block';
                    videoBtn.style.display = 'flex';
                    switchBtn.style.display = 'flex';
                }
            }
            
            async initRTC() {
                try {
                    // æ£€æŸ¥é˜¿é‡Œäº‘RTC SDKæ˜¯å¦æ­£ç¡®åŠ è½½
                    if (typeof AliRTCSdk === 'undefined') {
                        this.showError('é˜¿é‡Œäº‘RTC SDKåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å¹¶åˆ·æ–°é¡µé¢');
                        return;
                    }
                    
                    // å®‰å…¨è·å–AppID
                    const appId = await window.ALIYUN_CONFIG.getAppId();
                    
                    if (!appId || appId.trim() === '') {
                        this.showError('AppIDé…ç½®ä¸ºç©ºï¼Œè¯·é‡æ–°é…ç½®');
                        return;
                    }
                    
                    console.log('å¼€å§‹åˆå§‹åŒ–RTCï¼ŒAppID:', appId.substring(0, 8) + '***');
                    
                    // åˆ›å»ºRTCå¼•æ“
                    this.rtcEngine = AliRTCSdk.createClient({
                        appId: appId,
                        scene: 'communication'
                    });
                    
                    if (!this.rtcEngine) {
                        this.showError('RTCå¼•æ“åˆ›å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥AppIDæ˜¯å¦æ­£ç¡®');
                        return;
                    }
                    
                    // è®¾ç½®äº‹ä»¶ç›‘å¬
                    this.setupEventListeners();
                    
                    // åŠ å…¥é¢‘é“
                    await this.joinChannel();
                    
                } catch (error) {
                    console.error('åˆå§‹åŒ–RTCå¤±è´¥:', error);
                    let errorMsg = 'åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥';
                    
                    // æ ¹æ®é”™è¯¯ç±»å‹æä¾›æ›´å…·ä½“çš„é”™è¯¯ä¿¡æ¯
                    if (error.name === 'NotAllowedError') {
                        errorMsg = 'è¯·å…è®¸è®¿é—®æ‘„åƒå¤´å’Œéº¦å…‹é£æƒé™';
                    } else if (error.name === 'NotFoundError') {
                        errorMsg = 'æœªæ‰¾åˆ°æ‘„åƒå¤´æˆ–éº¦å…‹é£è®¾å¤‡';
                    } else if (error.message && error.message.includes('appId')) {
                        errorMsg = 'AppIDé…ç½®é”™è¯¯ï¼Œè¯·æ£€æŸ¥é…ç½®';
                    } else if (error.message && error.message.includes('network')) {
                        errorMsg = 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®';
                    }
                    
                    this.showError(errorMsg);
                }
            }
            
            setupEventListeners() {
                // è¿œç¨‹ç”¨æˆ·å‘å¸ƒæµ
                this.rtcEngine.on('user-published', async (user, mediaType) => {
                    console.log('è¿œç¨‹ç”¨æˆ·å‘å¸ƒ:', user.userId, mediaType);
                    await this.subscribeRemoteUser(user, mediaType);
                });
                
                // è¿œç¨‹ç”¨æˆ·å–æ¶ˆå‘å¸ƒæµ
                this.rtcEngine.on('user-unpublished', (user, mediaType) => {
                    console.log('è¿œç¨‹ç”¨æˆ·å–æ¶ˆå‘å¸ƒ:', user.userId, mediaType);
                    this.handleUserLeft(user.userId);
                });
                
                // ç”¨æˆ·ç¦»å¼€é¢‘é“
                this.rtcEngine.on('user-left', (user) => {
                    console.log('ç”¨æˆ·ç¦»å¼€é¢‘é“:', user.userId);
                    this.handleUserLeft(user.userId);
                });
                
                // ç½‘ç»œçŠ¶æ€å˜åŒ–
                this.rtcEngine.on('network-quality', (stats) => {
                    console.log('ç½‘ç»œè´¨é‡:', stats);
                });
                
                // è¿æ¥çŠ¶æ€å˜åŒ–
                this.rtcEngine.on('connection-state-changed', (newState, reason) => {
                    console.log('è¿æ¥çŠ¶æ€å˜åŒ–:', newState, reason);
                });
            }
            
            async joinChannel() {
                try {
                    // è·å–æœ¬åœ°åª’ä½“æµ
                    if (this.callType === 'video') {
                        // è§†é¢‘é€šè¯ï¼šéŸ³é¢‘+è§†é¢‘
                        this.localTracks.video = await AliRTCSdk.createCameraVideoTrack({
                            cameraId: 'default',
                            encoderConfig: '720p_1'
                        });
                        this.localTracks.audio = await AliRTCSdk.createMicrophoneAudioTrack();
                        
                        // æ’­æ”¾æœ¬åœ°è§†é¢‘
                        this.localTracks.video.play('localVideo');
                    } else {
                        // éŸ³é¢‘é€šè¯ï¼šä»…éŸ³é¢‘
                        this.localTracks.audio = await AliRTCSdk.createMicrophoneAudioTrack();
                    }
                    
                    // åŠ å…¥é¢‘é“ï¼ˆå…Tokenæ¨¡å¼ï¼‰
                    await this.rtcEngine.join(
                        '',  // tokenä¸ºç©º
                        this.roomId,
                        this.userId
                    );
                    
                    // å‘å¸ƒæœ¬åœ°æµ
                    const tracksToPublish = [];
                    if (this.localTracks.audio) tracksToPublish.push(this.localTracks.audio);
                    if (this.localTracks.video) tracksToPublish.push(this.localTracks.video);
                    
                    await this.rtcEngine.publish(tracksToPublish);
                    
                    this.isJoined = true;
                    this.hideWaitingScreen();
                    
                    console.log('æˆåŠŸåŠ å…¥æˆ¿é—´:', this.roomId);
                    
                } catch (error) {
                    console.error('åŠ å…¥æˆ¿é—´å¤±è´¥:', error);
                    this.showError('åŠ å…¥æˆ¿é—´å¤±è´¥: ' + error.message);
                }
            }
            
            async subscribeRemoteUser(user, mediaType) {
                try {
                    await this.rtcEngine.subscribe(user, mediaType);
                    
                    if (mediaType === 'video' && this.callType === 'video') {
                        // æ’­æ”¾è¿œç¨‹è§†é¢‘
                        user.videoTrack.play('remoteVideo');
                    } else if (mediaType === 'audio') {
                        // å¤„ç†è¿œç¨‹éŸ³é¢‘
                        this.handleRemoteAudio(user);
                    }
                    
                    this.remoteTracks[user.userId] = user;
                    this.updateRemoteUserInfo(user.userId);
                    
                } catch (error) {
                    console.error('è®¢é˜…è¿œç¨‹ç”¨æˆ·å¤±è´¥:', error);
                }
            }
            
            handleRemoteAudio(user) {
                if (this.callType === 'audio') {
                    // æ˜¾ç¤ºéŸ³é¢‘å¯è§†åŒ–
                    document.getElementById('audioVisualizer').style.display = 'flex';
                    document.getElementById('remoteUserName').textContent = `æ­£åœ¨é€šè¯: ${user.userId}`;
                    document.getElementById('callStatus').textContent = 'éŸ³é¢‘é€šè¯ä¸­';
                }
            }
            
            updateRemoteUserInfo(userId) {
                if (this.callType === 'audio') {
                    document.getElementById('remoteUserName').textContent = `æ­£åœ¨é€šè¯: ${userId}`;
                }
            }
            
            handleUserLeft(userId) {
                if (this.remoteTracks[userId]) {
                    delete this.remoteTracks[userId];
                }
                
                if (this.callType === 'audio') {
                    document.getElementById('audioVisualizer').style.display = 'none';
                    document.getElementById('remoteUserName').textContent = 'ç­‰å¾…å¯¹æ–¹åŠ å…¥...';
                    document.getElementById('callStatus').textContent = 'éŸ³é¢‘é€šè¯';
                }
            }
            
            hideWaitingScreen() {
                document.getElementById('waitingScreen').style.display = 'none';
            }
            
            showError(message) {
                console.error('æ˜¾ç¤ºé”™è¯¯:', message);
                
                // æ›´æ–°é”™è¯¯ä¿¡æ¯
                document.getElementById('errorMessage').textContent = message;
                
                // æ·»åŠ è¯¦ç»†çš„è§£å†³å»ºè®®
                let suggestions = '';
                if (message.includes('AppID')) {
                    suggestions = 'è¯·ç¡®ä¿åœ¨URLä¸­æ·»åŠ æ­£ç¡®çš„AppIDå‚æ•°ï¼š?appId=æ‚¨çš„AppID';
                } else if (message.includes('ç½‘ç»œ')) {
                    suggestions = 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿å¯ä»¥è®¿é—®é˜¿é‡Œäº‘æœåŠ¡';
                } else if (message.includes('SDK')) {
                    suggestions = 'è¯·æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œç¡®ä¿å¯ä»¥åŠ è½½å¤–éƒ¨JavaScriptæ–‡ä»¶';
                } else if (message.includes('æƒé™')) {
                    suggestions = 'è¯·åœ¨æµè§ˆå™¨ä¸­å…è®¸è®¿é—®æ‘„åƒå¤´å’Œéº¦å…‹é£';
                } else if (message.includes('è®¾å¤‡')) {
                    suggestions = 'è¯·ç¡®ä¿æ‘„åƒå¤´å’Œéº¦å…‹é£è®¾å¤‡è¿æ¥æ­£å¸¸';
                }
                
                if (suggestions) {
                    document.getElementById('errorMessage').innerHTML = 
                        message + '<br><br><small style="color: #ccc;">è§£å†³å»ºè®®: ' + suggestions + '</small>';
                }
                
                // æ˜¾ç¤ºé”™è¯¯ç•Œé¢
                document.getElementById('errorScreen').style.display = 'flex';
                document.getElementById('waitingScreen').style.display = 'none';
                
                // 5ç§’åè‡ªåŠ¨æä¾›é…ç½®é€‰é¡¹
                setTimeout(() => {
                    if (message.includes('AppID') && window.ALIYUN_CONFIG) {
                        const retryBtn = document.querySelector('.retry-btn');
                        if (retryBtn) {
                            retryBtn.innerHTML = 'é‡æ–°é…ç½®AppID';
                            retryBtn.onclick = () => window.ALIYUN_CONFIG.promptForAppId();
                        }
                    }
                }, 5000);
            }
            
            async toggleMute() {
                if (!this.isJoined || !this.localTracks.audio) return;
                
                try {
                    if (this.isAudioMuted) {
                        await this.localTracks.audio.setEnabled(true);
                        document.getElementById('muteBtn').textContent = 'ğŸ¤';
                        document.getElementById('muteBtn').classList.remove('active');
                    } else {
                        await this.localTracks.audio.setEnabled(false);
                        document.getElementById('muteBtn').textContent = 'ğŸ¤âŒ';
                        document.getElementById('muteBtn').classList.add('active');
                    }
                    this.isAudioMuted = !this.isAudioMuted;
                } catch (error) {
                    console.error('åˆ‡æ¢é™éŸ³å¤±è´¥:', error);
                }
            }
            
            async toggleVideo() {
                if (!this.isJoined || !this.localTracks.video || this.callType === 'audio') return;
                
                try {
                    if (this.isVideoMuted) {
                        await this.localTracks.video.setEnabled(true);
                        document.getElementById('videoBtn').textContent = 'ğŸ“¹';
                        document.getElementById('videoBtn').classList.remove('active');
                    } else {
                        await this.localTracks.video.setEnabled(false);
                        document.getElementById('videoBtn').textContent = 'ğŸ“¹âŒ';
                        document.getElementById('videoBtn').classList.add('active');
                    }
                    this.isVideoMuted = !this.isVideoMuted;
                } catch (error) {
                    console.error('åˆ‡æ¢è§†é¢‘å¤±è´¥:', error);
                }
            }
            
            async switchCamera() {
                if (!this.localTracks.video || this.callType === 'audio') return;
                
                try {
                    await this.localTracks.video.switchDevice();
                } catch (error) {
                    console.error('åˆ‡æ¢æ‘„åƒå¤´å¤±è´¥:', error);
                }
            }
            
            async hangup() {
                try {
                    if (this.rtcEngine) {
                        await this.rtcEngine.leave();
                    }
                    
                    // åœæ­¢æœ¬åœ°è½¨é“
                    if (this.localTracks.video) {
                        this.localTracks.video.stop();
                    }
                    if (this.localTracks.audio) {
                        this.localTracks.audio.stop();
                    }
                    
                    // å°è¯•å…³é—­çª—å£ï¼Œå¦‚æœä¸èƒ½å…³é—­åˆ™æ˜¾ç¤ºç»“æŸä¿¡æ¯
                    if (window.history.length <= 1) {
                        document.body.innerHTML = `
                            <div class="error-screen">
                                <h2>é€šè¯å·²ç»“æŸ</h2>
                                <p>æ„Ÿè°¢ä½¿ç”¨æˆ‘ä»¬çš„æœåŠ¡</p>
                                <button class="retry-btn" onclick="window.close()">å…³é—­é¡µé¢</button>
                            </div>
                        `;
                    } else {
                        window.close();
                    }
                } catch (error) {
                    console.error('æŒ‚æ–­å¤±è´¥:', error);
                    window.close();
                }
            }
        }
        
        // å…¨å±€å®ä¾‹å’Œå‡½æ•°
        let videoChat;
        
        window.onload = () => {
            videoChat = new VideoChat();
        };
        
        function toggleMute() {
            videoChat.toggleMute();
        }
        
        function toggleVideo() {
            videoChat.toggleVideo();
        }
        
        function switchCamera() {
            videoChat.switchCamera();
        }
        
        function hangup() {
            videoChat.hangup();
        }
        
        // é¡µé¢å¸è½½æ—¶æ¸…ç†èµ„æº
        window.onbeforeunload = () => {
            if (videoChat && videoChat.rtcEngine) {
                videoChat.rtcEngine.leave();
            }
        };
    </script>
</body>
</html>